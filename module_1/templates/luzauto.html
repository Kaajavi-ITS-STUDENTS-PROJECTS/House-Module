{% extends 'base.html' %}
{% load static %}
{% block titulo %}
<title>Luz Auto</title>
<link rel="stylesheet" href="{% static 'css/nouislider.css' %}">
{% endblock %}
{% block content %}


<div class="card  blue-grey darken-1">
    <div id="dias" style="padding-left: 150px;">
        <p class="check-inline">
            <input type="checkbox" id="d" />
            <label for="d">Domingo</label>
        </p>
        <p class="check-inline">
            <input type="checkbox" id="l" />
            <label for="l">Lunes</label>
        </p>
        <p class="check-inline">
            <input type="checkbox" id="m" />
            <label for="m">Martes</label>
        </p>
        <p class="check-inline">
            <input type="checkbox" id="mi" />
            <label for="mi">Miercoles</label>
        </p>
        <p class="check-inline">
            <input type="checkbox" id="j" />
            <label for="j">Jueves</label>
        </p>
        <p class="check-inline">
            <input type="checkbox" id="v" />
            <label for="v">Viernes</label>
        </p>
        <p class="check-inline">
            <input type="checkbox" id="s" />
            <label for="s">Sabado</label>
        </p>
    </div>


    <!--<div class="btn" onclick="getSelected()"></div>-->
    <div class="valign-wrapper row" style="min-height:60px;">
        <div id="slider" class="col s10 offset-s1 valign"></div>
    </div>
    <div class="container">
        <select id="cmb">
            <option value="" disabled selected>Choose your option</option>
            {% for pin,nombre in pins.items %}
            <option id='{{pin}}'>{{nombre}}</option>
            {% endfor %}
        </select>
        <!-- {% for pin,nombre in pins.items %}
<p class="check-inline">
<input type="checkbox" id="{{pin}}" />
<label for="{{pin}}">{{nombre}}</label>
</p>
{% endfor %}-->
        <div class="right">
            <p class="check-inline">
                <input type="checkbox" id="on" />
                <label for="on">Prender</label>
            </p>
            <a class="waves-effect btn-flat white-text" onclick="add_rule()">Crear</a>
        </div>
    </div>
</div>


{% endblock %}
{% block scripts %}
<script type="text/javascript" src="{% static 'js/nouislider.min.js' %}"></script>
<script>
    function add_rule(){
        var data={
            csrfmiddlewaretoken: '{{ csrf_token }}',
            nombre: $('#cmb').children(":selected").innerHTML,
            id: $('#cmb').children(":selected").attr("id"),
            status: $('#on').is(':checked'),

        }
        $.ajax({
            method: "POST",
            url: "{% url 'module_1:add_rule' %}",
            data: data,
            success:function(result){
               console.log("Anduvo")
            },
            error: function(e){
                console.log(e.responseText);
            }
        });
    }
    function getSelected(){
        /*var e = $('select option:selected');
        console.log(e);*/
        $('input').each(function(){
            if($(this).is(':checked')){
                console.log($('label[for="' + this.id + '"]').html());
            }
        });
    }

    $(document).ready(function() {
        $('select').material_select();
        $('.collapsible').collapsible({
            accordion : false
        });
    });

    var slider = document.getElementById('slider');
    noUiSlider.create(slider, {
        start: ["02:00","21:00"],
        connect: true,
        step: 1,
        range: {
            'min': 0,
            'max': 1439
        },
        format:{
            to: minutesToHHMM,
            from: HHMMtoMinutes
        },
    });

    function minutesToHHMM(value) {
        value = Math.round(value);
        var hour = Math.floor(value / 60);
        var min = value - hour * 60;
        return ("0" + hour).slice(-2) + ":" + ("0" + min).slice(-2);
    }

    function HHMMtoMinutes(value) {
        var split = value.toString().split(":");
        var hour = parseInt(split[0]) * 60;
        var min = parseInt(split[1]);
        return hour + min;
    }

</script>
{% endblock %}
